<!DOCTYPE html>
<html>
<head>
    <title>Live Candlestick Chart</title>
    <script src="https://unpkg.com/lightweight-charts@5/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        body { margin: 0; background: #111; }
        #chart { width: 100vw; height: 100vh; }
    </style>
</head>
<body>

<div id="chart"></div>

<script>
    const chart = LightweightCharts.createChart(
        document.getElementById('chart'),
        {
            layout: {
                background: { color: '#111' },
                textColor: '#DDD',
            },
            grid: {
                vertLines: { color: '#333' },
                horzLines: { color: '#333' },
            },
            timeScale: {
                timeVisible: true,
                secondsVisible: true,
            }
        }
    );

    // âœ… v5 API
    const candleSeries = chart.addSeries(
        LightweightCharts.CandlestickSeries,
        {
            upColor: '#26a69a',
            downColor: '#ef5350',
            wickUpColor: '#26a69a',
            wickDownColor: '#ef5350',
            borderVisible: false,
        }
    );

    const socket = new WebSocket("ws://localhost:8765");

    socket.onmessage = (event) => {
        const candle = JSON.parse(event.data);
        candleSeries.update(candle);
    };
</script>

</body>
</html>
